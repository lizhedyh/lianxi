# 快速接入

## 开始接入

### 第一步：安装 thunder 依赖

```bash

npm install @mtfe/thunder -S

```

### 第二步：配置 thunder webpack 插件

推荐在 `非开发环境` webpack 配置中引入 `Thunder`, 因为 `Thunder` 的缓存特性在开发中并不需要。

```javascript
// webpack.conf.production.js

const ThunderPlugin = require('@mtfe/thunder/plugin')

const webpackConfig = {

  plugins: [
    ...
    new ThunderPlugin({
      project: 'com.meituan.era',
      injectHTML: {
        template: path.resolve(__dirname, 'path/to/your/template/index.html'),
        chunks: ['manifest', 'vendor', 'app']
      }
    })
    ...
  ]
  ...
}
```

你需要配置的是 `injectHTML` 中 `chunks` 这里是为了调用 thunder loader 加载第三方资源模块 (vendor)以及入口模块 (app), 请根据项目的相关配置填写这里的配置。

### 第三步：

配置完成，开始开发！

```bash

npm run dev

```

### 更多配置

```javascript
const webpackConfig = {

  plugins: [
    ...
    new ThunderPlugin({
      project: 'com.meituan.era',
      injectHTML: {
        chunks: ['vendor', 'app'],

        template: path.resolve(__dirname, 'path/to/your/template/index.html'),

        // 支持 glob 风格路径名称
        template: path.resolve(__dirname, 'path/to/your/template/*.html'),

        // 默认输出文件名称和原始模板一致，也可通过 filename 来自定义名称
        filename: 'app.html',
        
        // chunks 是一种快速配置如下格式的 content 方式，不过你可以可以通过自定义 content 来完成自定义需求
        content: `;(function (global) {
          const thunder = global.__thunder__;
          thunder.parallel(['manifest', 'vendor', 'app']);
        })(window)`
      }
    })
    ...
  ]
  ...
}
```

### 多个入口和模板 ？

`injectHTML` 同时支持数组参数，元素选项和单个一致。

```javascript
const webpackConfig = {

  plugins: [
    ...
    new ThunderPlugin({
      project: 'com.meituan.era',
      injectHTML: [{
        chunks: ['manifest', 'vendor', 'app'],
        template: path.resolve(__dirname, 'path/to/your/template/index.html'),
        inline: true
      }, {
        chunks: ['manifest', 'vendor', 'other-app'],
        template: path.resolve(__dirname, 'path/to/your/template/other-template.html'),
        inline: true
      }]
    })
    ...
  ]
  ...
}
```


### JS 注入位置控制

在 HTML 模板中添加 `<!--thunder-script-inject-->` 和 `<!--thunder-style-inject-->/`，相关资源会替换注入到相应的位置

```html
<header>
  <title></title>
  <!--thunder-style-inject-->/
</header>
<body>
  <div id="app"></div>

  <!--thunder-script-inject-->
</body>
```

## 更多配置：

请参考 [详细配置](https://docs.sankuai.com/doc/zcm/fe-offlinify/)

