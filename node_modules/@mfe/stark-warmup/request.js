const axios = require('axios');
const { version } = require('./package.json');

const DEFAULT_HOST = 'http://starkwarmup.fe.vip.sankuai.com';

function request(url) {
  const actualUrl = DEFAULT_HOST + url;
  return axios({
    url: actualUrl,
    timeout: 120 * 1000,
    validateStatus: status => status > 0,
    headers: {
      'User-Agent': `Stark-Warmup ${version}`,
    },
  }).then(response => {
    console.log(actualUrl, 'diff-status:', response.headers['diff-status']);
    return new Promise(resolve => setTimeout(resolve, 1000));
  });
}

module.exports = {
  request,
};